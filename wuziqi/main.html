<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>game 1</title>
        <style media="screen">
            canvas {
                border: 1px black solid;
            }
        </style>
    </head>
    <body>
        <canvas id="id-canvas" width="400" height="300"></canvas>
<script>
var log = console.log.bind(console)

var drawBoard = function(board) {
    for(let i=0; i<board.length; i++) {
        let row = board[i]
        log(row.join(' '))
    }
 }

var step = function(board, x, y, ball) {
    let res = false
    if (board[x][y] === ball) {
        return { res, ball }
    }

    board[x][y] = ball
    drawBoard(board)

    var pos= {x, y}
    res = checkBoard(board, pos, ball)
    log(res)

    return res
}

var checkBoard = function(board,pos,ball) {
    const winCount = 5
    let done = false
    var res1 = getHor(board, pos, ball)
    var res2 = getVer(board, pos, ball)
    var res3 = getLeftup2Rightdown(board, pos, ball)
    var res4 = getLeftdown2Rightup(board, pos, ball)

    var a = [res1, res2, res3, res4]
    for(let i=0; i<a.length; i++) {
        if (a[i] === winCount) {
            done = true
            break
        }
    }
    return { done, ball }
}

var getHor = function(board, pos, ball) {
    var x = pos.x
    var y = pos.y
    var width = board[0].length
    var left = 0
    var right = 0

    for(let j=y+1; j<width; j++){
        if(board[x][j] === ball){
            right += 1
        } else {
            break
        }
    }

    for(let i=y-1; i>=0; i--){
        if(board[x][i] === ball){
            left += 1
        }else{
            break
        }
    }

    return left + right + 1
}

var getVer = function(board, pos, ball) {
    var x = pos.x
    var y = pos.y
    var height = board.length
    var up = 0
    var down = 0

    for(let i=x+1; i<height; i++){
        if(board[i][y] === ball){
            down += 1
        }else{
            break
        }
    }

    for(let j=x-1; j>=0; j--){
        if(board[j][y] === ball){
            up += 1
        }else{
            break
        }
    }

    return up + down + 1
}

var getLeftup2Rightdown = function(board, pos, ball) {
    var x = pos.x
    var y = pos.y
    var width = board[0].length
    var height = board.length
    var leftUp = 0
    var rightDown = 0

    for(let i=x-1, j=y-1; ((i>=0) && (j>=0)); i--, j--){
        if(board[i][j] === ball) {
            leftUp += 1
        }else {
            break
        }
    }

    for(let i=x+1, j=y+1; ((i<width) && (j<height)); i++, j++){
        if(board[i][j] === ball) {
            rightDown += 1
        }else {
            break
        }
    }

    return leftUp + rightDown + 1
}

var getLeftdown2Rightup = function(board, pos ,ball) {
    var x = pos.x
    var y = pos.y
    var width = board[0].length
    var height = board.length
    var leftDown = 0
    var rightUp = 0

    for(let i=x+1, j=y-1; ((i<height) && (j>=0)); i++, j--){
        if(board[i][j] === ball) {
            leftDown += 1
        }else {
            break
        }
    }

    for(let i=x-1, j=y+1; ((i>=0) && (j<width)); i--,j++){
        if(board[i][j] === ball) {
            rightUp += 1
        }else {
            break
        }
    }

    return leftDown + rightUp + 1
}

const board = new Array()
for(let i=0; i < 6; i++) {
    board[i] = new Array(i)
    for(let j=0; j<6; j++) {
        board[i][j] = '.'
    }
}


var __main = function() {
    function getRandomInt(min, max) {
        min = Math.ceil(min);
        max = Math.floor(max);
        return Math.floor(Math.random() * (max - min)) + min; //不含最大值，含最小值
    }

    let count = 40
    for (let i=0, j=0; count > 0; count--) {
        let res = step(board, i, j, '*')

        i = getRandomInt(0, 6)
        j = getRandomInt(0, 6)
        if ((i>=6) || (j>=6)) {
            continue
        }

        if (res.done) {
            break
        }
    }
}

__main()
</script>
</body>
</html>
